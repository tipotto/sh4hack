# sh4hack
![sh4hack2](https://user-images.githubusercontent.com/39334151/194248506-345b6404-ff66-4ae4-90bc-fb29cd95221f.png)

## Description

![metasploit](https://user-images.githubusercontent.com/39334151/194247080-fd3069b0-ab74-4be4-b047-690e9495ad7f.gif)

個人的なハッキング学習を効率化するために開発した、自作ツール（Emacs 拡張機能）です。  
僕自身、普段 Emacs というエディタを愛用しており、その特有のキーバインドに慣れ親しんでいるため、
ターゲットサーバーでの作業を含め、その大部分をローカル PC の Emacs 環境で行うことを目指しています。主に、

1. 頻繁に実行する処理の自動化
2. コマンドスニペットの管理
3. Emacs とターミナルの相互連携 etc. 

を行っています。

## Overview
### 1. Metasploit でのセッション確立の自動化
<details>
  <summary>処理の詳細</summary>

  想定シナリオ：  
  既存の脆弱性を利用して、ターゲットサーバーへの侵入に成功したが、既存のシェルでは操作性が良くない場合。  

  処理内容：  
  Metasploit での Meterpreter シェルのセッション確立を自動化します。具体的には、以下の処理を実行します。
  - MSFvenom でのペイロードの生成
  - Metasploit の multi/handler の起動
  - ターゲットサーバーへのペイロードの転送、実行 etc.
</details>

動画：https://youtu.be/FLfxcJAL4kM

---

### 2. Socat でのセッション確立の自動化
<details>
  <summary>処理の詳細</summary>

  想定シナリオ：  
  既存の脆弱性を利用して、ターゲットサーバーへの侵入に成功したが、既存のシェルでは操作性が良くない場合。  

  処理内容：  
  Socat でのセッション確立を自動化します。具体的には、以下の処理を実行します。
  - Socat のダウンロード
  - Socat リスナーの起動
  - ターゲットサーバーへの Socat の転送、実行 etc.
</details>

動画：https://youtu.be/1PXs0Py_ETQ

---

### 3. Netcat シェルのアップグレードの自動化
<details>
  <summary>処理の詳細</summary>
  
  想定シナリオ：  
  既存の脆弱性を利用して、ターゲットサーバーへの侵入に成功し、Netcat シェルのセッションが確立済みの場合。  

  処理内容：  
  Netcat シェルのアップグレード処理を自動実行します。一連の処理完了後には、ターゲットサーバー上で以下の操作が可能になります。
  - Ctrl-f, Ctrl-b, Ctrl-a, Ctrl-e でのカーソル移動
  - Ctrl-i でのコマンド補完
  - Ctrl-n, Ctrl-p でのコマンド履歴の操作
  - Ctrl-c でのジョブ停止
  - nano, vi 等のエディタでのファイル編集 etc.
</details>

動画：https://youtu.be/RwHtlpLLG84

---

### 4. ターゲットサーバーの検査
<details>
  <summary>処理の詳細</summary>

  想定シナリオ：  
  既存の脆弱性を利用して、ターゲットサーバーへの侵入に成功したが、既存のシェルでは操作性が良くないため、公開鍵認証による SSH 接続を検討する場合。  

  処理内容：  
  ターゲットサーバー上に、特定のユーザーのホームディレクトリ、及び .ssh ディレクトリが存在するかを検査します（SSH に限らず、今後必要に応じて様々な検査項目を追加予定）。
</details>

動画：https://youtu.be/EmOyeAAvuRw

---

### 5. ターゲットサーバーへの SSH 接続
ローカル PC の Emacs でターゲットサーバーのファイルを編集できる機能です (Emacs の Tramp という拡張機能を利用)。  
パスワード認証、公開鍵認証に対応しています。

<details>
  <summary>公開鍵認証では、以下の処理を自動化します。</summary>

  - 認証に用いるキーペアの生成
  - SSH の config ファイルの生成
  - ターゲットサーバーへの公開鍵の転送、登録  
</details>

動画：https://youtu.be/BS_PqpEgHG8

---

### 6. リモートファイルの編集
ターゲットサーバーのファイルをダウンロードし、ローカル PC の Emacs で編集する機能です。  
既存のファイルが存在しない場合、新規作成することも可能です。  
編集内容はターゲットサーバーに自動的に書き込まれます (Emacs の Tramp を用いた SSH 接続は動作が重く、代替機能として実装)。

動画：https://youtu.be/77VgX-9GCrE

---

### 7. ローカルファイルの転送、実行
スキャニング用のスクリプトなどをターゲットサーバーに転送、実行する機能です。  
実行結果はローカル PC のファイルに書き込むこともできるため、Emacs で操作可能です。

動画：

---

### 8. リモートファイルのダウンロード
ターゲットサーバー上のファイルをローカル PC にダウンロードする機能です。

動画：

---

### 9. コマンドスニペットの管理
頻繁に実行するコマンドのスニペットを管理できる機能です。  
手軽にスニペットを編集したり、ワンタッチでコマンドを実行することができます。  
実行するコマンドがワードファイルを必要とする場合、選択したファイルのパスが自動的にスニペットに挿入されます。

動画：

---

### 10. Multi-term の拡張機能の提供
Multi-term（Emacs 上で動作するターミナルエミュレーター）ではサポートされていない、Multi-term と Emacs 間のクリップボード共有など、相互連携に必要な機能を提供します。

<details>
  <summary>以下の操作を可能にします。</summary>

  - Multi-term でコピーしたテキストを Emacs のクリップボードに保存
  - Multi-term でカット（切り取り）したテキストを Emacs のクリップボードに保存
  - Multi-term で行頭からカットしたテキストを Emacs のクリップボードに保存
  - Multi-term で行末からカットしたテキストを Emacs のクリップボードに保存
  - Multi-term と Emacs で競合するキー（C-x, C-z etc.）における、送信先アプリケーションの切り替え
  - Multi-term のカレントディレクトリのファイルを、Emacs で手軽に検索
</details>